ci:
  skip:
    - markdown-link-check

repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v6.0.0
    hooks:
      - id: check-merge-conflict
      - id: check-added-large-files
        args: ["--maxkb=128"]
      - id: end-of-file-fixer
      - id: trailing-whitespace

  - repo: https://github.com/psf/black
    rev: 25.9.0 # sync:black:tests/functional/poetry.lock
    hooks:
      - id: black

  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v4.0.0-alpha.8
    hooks:
      - id: prettier
        types:
          - markdown
          - javascript
          - ts
          - json

  # TODO(@mbaltrusitis): switch to yarn and utilize this in below
  - repo: https://github.com/crashappsec/pre-commit-sync
    rev: 0.1.0.a3
    hooks:
      - id: pre-commit-sync

  ## serverless-plugin-crashoverride hooks
  - repo: https://github.com/pre-commit/mirrors-eslint
    rev: v8.56.0
    hooks:
      - id: eslint
        name: ESLint (serverless-plugin-crashoverride)
        files: ^serverless-plugin-crashoverride/.*\.ts$
        args: ['--fix', '--config', '.eslintrc.json']
        additional_dependencies:
          - eslint@8.56.0
          - typescript@5.3.3
          - '@typescript-eslint/parser@6.18.1'
          - '@typescript-eslint/eslint-plugin@6.18.1'

  ## serverless-plugin-crashoverride final

  # - repo: local
  #   hooks:
  #
  # - id: licenseheaders
  #   name: licenseheaders
  #   language: python
  #   additional_dependencies:
  #     - https://github.com/johann-petrak/licenseheaders/archive/8e2d6f944aea639d62c8d26cd99dab4003c3904d.zip
  #   entry: ./.github/check_license.sh
  #   files: \.(nim|c4m|c42spec|bash|py)$
  #   args:
  #     - --tmpl=.github/copyright.tmpl
  #     # - --current-year
  #     # - --years=2022,2023
  #     - --projname=Chalk
  #     - --projurl=https://crashoverride.com/docs/chalk
  #     - --additional-extensions
  #     - script=.nim,.c4m,.c42spec,.bash
  #     - robot=.py # native python each run adds another newline
  #     - --files
  #     - --
  #   # selfsigned is not our copyright
  #   # data has test data for python encoding so we leave it alone
  #   exclude: |
  #     (?x)(
  #       selfsigned.py|
  #       defaultconfig.c4m|
  #       configs/.*.c4m|
  #       tests/.*.c4m|
  #       data/.*
  #     )$

  - repo: https://github.com/tcort/markdown-link-check
    rev: v3.13.7
    hooks:
      - id: markdown-link-check
        args:
          - -q
          - -c
          - .github/.md-link-check.json

  # Shellcheck for shell script linting
  - repo: https://github.com/shellcheck-py/shellcheck-py
    rev: v0.11.0.1
    hooks:
      - id: shellcheck
        name: Lint shell scripts
        files: (^dust-lambda-extension/extensions/.*\.(sh|bash)$|dust$)

  # Shell script formatting with shfmt
  - repo: https://github.com/scop/pre-commit-shfmt
    rev: v3.12.0-2
    hooks:
      - id: shfmt
        name: Format shell scripts
        files: (^dust-lambda-extension/extensions/.*\.(sh|bash)$|dust$)
